statement ok
START TRANSACTION

statement ok
CREATE TABLE decimals(id INT, d DECIMAL(8,2))

--
-- this is the default behavior
--

statement ok
COPY 3 RECORDS INTO decimals FROM STDIN
<COPY_INTO_DATA>
1| 123.45
2|+123.45
3|-123.45

query T
SELECT d FROM decimals ORDER BY id
----
123.45
123.45
-123.45

statement ok
DELETE FROM decimals

--
-- customize the decimal separator
--

statement ok
COPY 3 RECORDS INTO decimals FROM STDIN DECIMAL AS ','
<COPY_INTO_DATA>
1| 123,45
2|+123,45
3|-123,45

query T
SELECT d FROM decimals ORDER BY id
----
123.45
123.45
-123.45

statement ok
DELETE FROM decimals

--
-- also set a thousands separator
--

statement ok
COPY 3 RECORDS INTO decimals FROM STDIN DECIMAL AS ',', '_'
<COPY_INTO_DATA>
1| 1_23,45
2|+1_23,45
3|-1_23,45

query T
SELECT d FROM decimals ORDER BY id
----
123.45
123.45
-123.45

statement ok
DELETE FROM decimals

--
-- the 'AS' is optional
--

statement ok
COPY 3 RECORDS INTO decimals FROM STDIN DECIMAL ',', '_'
<COPY_INTO_DATA>
1| 1_23,45
2|+1_23,4__5
3|-1_23,_45

query T
SELECT d FROM decimals ORDER BY id
----
123.45
123.45
-123.45

statement ok
DELETE FROM decimals
