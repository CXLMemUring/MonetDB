statement ok
j:= bat.new(:json)

statement ok
b:= json.new("[1,\"f2\", 2]")

statement ok
bat.append(j,b)

statement ok
b:= json.new("[]")

statement ok
bat.append(j,b)

statement ok
b:= json.new("[1,\"f2\", 2]")

statement ok
bat.append(j,b)

statement ok
f:bat[:json]:= mal.manifold("json","filter",j,0)

query TT rowsort
io.print(f)
----
@
[1]
@
[1]
@
[]

statement ok
f:bat[:json]:= mal.manifold("json","filter",j,1)

query TT rowsort
io.print(f)
----
@
["f2"]
@
["f2"]
@
[]

statement ok
f:bat[:json]:= mal.manifold("json","filter",j,2)

query TT rowsort
io.print(f)
----
@
[2]
@
[2]
@
[]

